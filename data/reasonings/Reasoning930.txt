<thinking>
1. Problem summary: Given a binary array, find the number of non-empty subarrays with a sum equal to the given goal.
2. Problem type / algorithm category: Prefix sum, Hash map.
3. Step-by-step approach: Use a hash map to store the frequency of prefix sums encountered so far. Iterate through the array, updating the current prefix sum. Check if (current_sum - goal) exists in the hash map. If it does, add its frequency to the result. Finally, update the frequency of the current prefix sum in the hash map.
4. Edge cases: Empty array, goal is 0, goal is larger than the array length.
5. Time and space complexity: Time complexity is O(n) because it iterates through the array once. Space complexity is O(n) in the worst case, as the prefix sum count hash map can store up to n distinct prefix sums.
</thinking>